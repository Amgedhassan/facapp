<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Facilities Companion</title>
    <!-- PWA Manifest & Meta Tags for "Add to Home Screen" -->
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Facilities">
    <meta name="apple-mobile-web-app-title" content="Facilities">
    <meta name="theme-color" content="#F9FAFB">
    <meta name="msapplication-navbutton-color" content="#F9FAFB">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/png" href="https://placehold.co/192x192/000000/ffffff?text=FC">
    <link rel="apple-touch-icon" href="https://placehold.co/180x180/000000/ffffff?text=FC">

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Red, Black, and White -->
    <!-- Application Structure Plan: To deliver a truly exceptional and "wow" experience, the app is architected as a native-like mobile PWA. The home screen is a dynamic, widget-based "Today" Hub that surfaces contextually relevant information (upcoming bookings, request statuses). Navigation is handled via fluid, full-screen transitions rather than modals, mimicking a premium native app. This structure prioritizes an effortless, predictive, and delightful user journey, making the app feel like an intelligent personal assistant, not a static corporate tool. -->
    <!-- Visualization & Content Choices: The application uses animated UI elements and intelligent, multi-step forms built with HTML/CSS/JS to create a fluid user experience. For example, the Room Reservation flow uses a custom-built interactive calendar. There is no need for traditional data charts. The "wow" factor is achieved through micro-interactions, predictive suggestions (simulated), and a context-aware design, all directly translating the process-oriented nature of the source material into the most intuitive and impressive format possible. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        html, body {
            overscroll-behavior-y: contain;
            font-family: 'Inter', sans-serif;
            background-color: #E5E7EB;
        }
        .mobile-screen {
            background-color: #F9FAFB;
            transform: scale(1);
            transition: transform 0.5s cubic-bezier(0.22, 1, 0.36, 1);
        }
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #F9FAFB;
            color: #1f2937;
            display: flex; flex-direction: column;
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
            pointer-events: none;
            z-index: 1;
        }
        .screen.active {
            opacity: 1;
            pointer-events: auto;
            z-index: 2;
        }
        
        .screen-header {
            flex-shrink: 0; display: flex; align-items: center; padding: 1rem;
            background-color: rgba(249, 250, 251, 0.8);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid #F3F4F6;
            z-index: 10;
        }
        .screen-title { font-size: 1.125rem; font-weight: 600; text-align: center; flex-grow: 1; color: #1f2937; }
        .screen-body { flex-grow: 1; overflow-y: auto; padding: 1.5rem; padding-bottom: 6rem; }
        .step-content { display: none; }
        .step-content.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .form-title { font-size: 1.75rem; font-weight: 800; color: #1f2937; text-align: center; }
        .form-subtitle { font-size: 1rem; color: #6B7280; text-align: center; margin-top: 0.5rem; max-width: 300px; margin-left:auto; margin-right:auto;}
        
        .option-button {
            width: 100%; display: flex; align-items: center; padding: 1rem; border: 1px solid #F3F4F6; border-radius: 0.75rem; font-weight: 600;
            transition: all 0.2s; background-color: #FFFFFF; box-shadow: 0 4px 12px -1px rgb(0 0 0 / 0.05); color: #1f2937;
        }
        .option-button:active, .primary-button:active, .nav-item:active, .action-sheet-item:active { transform: scale(0.98); transition: transform 0.1s; }
        
        .primary-button {
            background-color: #111827;
            color: white; padding: 0.875rem 1.5rem; border-radius: 0.75rem; font-weight: 600;
            width: 100%; transition: all 0.2s;
        }
        .primary-button:hover { background-color: #000; }
        
        .form-input { 
            width: 100%; padding: 0.75rem; border: 1px solid #E5E7EB; border-radius: 0.5rem; 
            background-color: #FFFFFF; color: #1f2937;
        }
        .form-input::placeholder { color: #9CA3AF; }

        .checkmark__circle { stroke-dasharray: 166; stroke-dashoffset: 166; stroke-width: 2; stroke-miterlimit: 10; stroke: #22c55e; fill: none; animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards; }
        .checkmark { width: 64px; height: 64px; border-radius: 50%; display: block; stroke-width: 3; stroke: #fff; stroke-miterlimit: 10; margin: 0 auto; box-shadow: inset 0px 0px 0px #22c55e; animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both; }
        .checkmark__check { transform-origin: 50% 50%; stroke-dasharray: 48; stroke-dashoffset: 48; animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards; }
        @keyframes stroke { 100% { stroke-dashoffset: 0; } }
        @keyframes scale { 0%, 100% { transform: none; } 50% { transform: scale3d(1.1, 1.1, 1); } }
        @keyframes fill { 100% { box-shadow: inset 0px 0px 0px 32px #22c55e; } }

        .load-in { opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        
        .styled-card { 
            background: #FFFFFF; 
            border: 1px solid #E5E7EB;
            border-radius: 1.25rem;
            box-shadow: 0 10px 25px -5px rgb(0 0 0 / 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .flat-icon { width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .icon-home { border: 2px solid currentColor; border-radius: 4px; position: relative; }
        .icon-home::after { content: ''; position: absolute; width: 8px; height: 8px; background-color: currentColor; border-radius: 1px; top: 4px; }
        .icon-activity { position: relative; }
        .icon-activity::before { content:''; position: absolute; width: 16px; height: 2px; background-color: currentColor; border-radius: 1px; top: 7px; }
        .icon-activity::after { content:''; position: absolute; width: 10px; height: 2px; background-color: currentColor; border-radius: 1px; top: 13px; }
        .icon-rooms { border: 2px solid currentColor; border-radius: 4px; }
        .icon-rooms::after { content: ''; position: absolute; width: 4px; height: 8px; border: 2px solid currentColor; border-radius: 50%; right: 2px; top: 4px; }
        .icon-requests { border: 2px solid currentColor; border-radius: 4px; }
        .icon-requests::before, .icon-requests::after { content: ''; position: absolute; width: 10px; height: 2px; background-color: currentColor; border-radius: 1px; left: 3px; }
        .icon-requests::before { top: 4px; }
        .icon-requests::after { top: 10px; }
        .icon-wellness { border: 2px solid currentColor; border-radius: 50%; }
        .icon-wellness::after { content: '+'; font-size: 14px; line-height: 1; font-weight: bold; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .icon-ticket { border: 2px solid currentColor; border-radius: 4px; }
        .icon-ticket::before { content: '!'; font-weight: bold; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);}
        .icon-calendar { border: 2px solid currentColor; border-radius: 4px; }
        .icon-calendar::before { content: ''; position: absolute; width: 12px; height: 2px; background-color: currentColor; top: 3px; left: 2px; }
        .icon-calendar::after { content: ''; position: absolute; width: 4px; height: 4px; background-color: currentColor; border-radius: 1px; top: 9px; left: 3px; }
        .icon-stationery { border: 2px solid currentColor; border-radius: 4px; }
        .icon-stationery::before, .icon-stationery::after { content: ''; position: absolute; background-color: currentColor; border-radius: 1px;}
        .icon-stationery::before { width: 2px; height: 8px; top: 3px; left: 5px; }
        .icon-stationery::after { width: 2px; height: 8px; top: 3px; right: 5px; }


        .confirmation-icon {
            font-size: 8rem; line-height: 1; opacity: 0; transform: scale(0.5);
            animation: zoomInFade 0.8s 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            position: absolute; top: 50%; left: 50%; margin-left: -4rem; margin-top: -4rem; z-index: 0;
        }
        @keyframes zoomInFade { to { opacity: 1; transform: scale(1); } }

        .nav-item { display: flex; flex-direction: column; align-items: center; color: #9CA3AF; transition: all 0.2s; padding: 0.25rem 0.5rem; flex-grow: 1; }
        .nav-item:hover { color: #111827; }
        .nav-item.active { color: #DC2626; } /* Red accent */
        .nav-item.active .flat-icon { transform: scale(1.1); }
        .nav-bar { background-color: #FFFFFF; border-top: 1px solid #E5E7EB; box-shadow: 0 -2px 10px 0 rgb(0 0 0 / 0.05); }
        
        .flat-icon-container { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; color: #9CA3AF; background-color: #F3F4F6; border-radius: 0.5rem; margin-right: 1rem; }
        
    </style>
</head>
<body class="bg-gray-200 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-sm h-[90vh] max-h-[850px] bg-gray-900 rounded-3xl shadow-2xl overflow-hidden relative mobile-screen">
        
        <main id="screen-main" class="screen active">
            <div class="screen-body">
                <header class="load-in flex justify-between items-center" style="transition-delay: 100ms;">
                    <div>
                        <h1 class="text-3xl font-extrabold text-gray-800 tracking-tighter" id="greeting"></h1>
                    </div>
                     <div class="w-12 h-12 rounded-full bg-red-600 text-white flex items-center justify-center text-lg font-bold">AM</div>
                </header>
                <button id="location-card" data-target-screen="screen-location" class="load-in styled-card p-4 mt-6 flex justify-between items-center w-full text-left" style="transition-delay: 200ms;">
                    <div>
                        <p class="text-xs text-gray-500">Your Location</p>
                        <p class="font-bold" id="current-location-display">Dallah Building, Alexandria</p>
                    </div>
                     <span class="text-sm font-semibold text-red-600">Change</span>
                </button>

                 <div class="mt-6">
                    <h2 class="load-in font-bold text-gray-800 mb-3" style="transition-delay: 300ms;">Services</h2>
                    <div class="load-in grid grid-cols-4 gap-4 text-center" style="transition-delay: 400ms;">
                        <button data-target-screen="screen-rooms" class="flex flex-col items-center space-y-2 p-2 rounded-xl hover:bg-gray-100/50">
                            <div class="flat-icon-container !m-0 !bg-red-50 !text-red-600"><div class="flat-icon icon-rooms"></div></div>
                            <span class="text-xs font-medium">Rooms</span>
                        </button>
                         <button data-target-screen="screen-requests" class="flex flex-col items-center space-y-2 p-2 rounded-xl hover:bg-gray-100/50">
                            <div class="flat-icon-container !m-0 !bg-red-50 !text-red-600"><div class="flat-icon icon-requests"></div></div>
                            <span class="text-xs font-medium">Requests</span>
                        </button>
                         <button data-target-screen="screen-wellness" class="flex flex-col items-center space-y-2 p-2 rounded-xl hover:bg-gray-100/50">
                            <div class="flat-icon-container !m-0 !bg-red-50 !text-red-600"><div class="flat-icon icon-wellness"></div></div>
                            <span class="text-xs font-medium">Wellness</span>
                        </button>
                         <button data-target-screen="screen-transport" class="flex flex-col items-center space-y-2 p-2 rounded-xl hover:bg-gray-100/50">
                            <div class="flat-icon-container !m-0 !bg-red-50 !text-red-600"><div class="flat-icon icon-ticket"></div></div>
                            <span class="text-xs font-medium">Transport</span>
                        </button>
                    </div>
                 </div>

                <div class="mt-6 space-y-4">
                    <h2 class="load-in font-bold text-gray-800" style="transition-delay: 500ms;">Recent Requests</h2>
                    <div id="requests-widget" class="load-in" style="transition-delay: 600ms;"></div>
                     <div id="ticket-widget" class="load-in styled-card p-4 bg-gray-800 text-white" style="transition-delay: 700ms;">
                         <button data-target-screen="screen-ticketing" class="w-full text-left flex items-center">
                            <div class="flat-icon-container !bg-red-500/50 !text-white"><div class="flat-icon icon-ticket"></div></div>
                            <div>
                                <p class="font-bold">Have an issue?</p>
                                <p class="text-xs text-gray-300">Submit a trouble ticket here</p>
                            </div>
                         </button>
                    </div>
                </div>
            </div>
        </main>

        <div id="screen-activity" class="screen">
            <div class="screen-header">
                <h2 class="screen-title">My Activity</h2>
            </div>
            <div class="screen-body">
                <div id="activity-log" class="space-y-4"></div>
            </div>
        </div>

        <div id="screen-location" class="screen">
            <div class="screen-header">
                <button class="navigate-back text-2xl font-bold text-gray-400 hover:text-gray-800">←</button>
                <h2 class="screen-title">Change Location</h2>
                <div class="w-8"></div>
            </div>
            <div class="screen-body">
                 <div class="space-y-4 mt-8" id="location-options">
                    <button class="option-button" data-location="Dallah Building, Alexandria">
                        Dallah Building, Alexandria
                        <span class="ml-auto"></span>
                    </button>
                    <button class="option-button" data-location="V-Hub 2, Smart Village">
                        V-Hub 2, Smart Village
                        <span class="ml-auto"></span>
                    </button>
                    <button class="option-button" data-location="Zayyan, Giza">
                        Zayyan, Giza
                        <span class="ml-auto"></span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- All other screens are structured similarly -->
        <div id="screen-rooms" class="screen">
            <div class="screen-header">
                <button class="navigate-back text-2xl font-bold text-gray-400 hover:text-gray-800">←</button>
                <h2 class="screen-title">Room Reservations</h2>
                <div class="w-8"></div>
            </div>
            <div class="screen-body">
                <div id="roomsStep1" class="step-content active"><h2 class="form-title">Room Type</h2><p class="form-subtitle">What kind of room do you need?</p><div class="space-y-4 mt-8"><button class="option-button" data-room-type="Fun Room"><span class="mr-4">🎮</span> Fun Room</button><button class="option-button" data-room-type="Meditation Room"><span class="mr-4">🧘</span> Meditation Room</button><button class="option-button" data-room-type="Lactation Room"><span class="mr-4">🍼</span> Lactation Room</button></div></div>
                <div id="roomsStep2" class="step-content"><h2 class="form-title">Meditation Room Rules</h2><p class="form-subtitle">Please acknowledge the guidelines to ensure a peaceful experience for everyone.</p><div class="mt-6 text-left bg-white p-4 rounded-lg space-y-3 text-sm text-gray-600 border border-gray-200"><p>✓ Sessions are limited to 30 minutes.</p><p>✓ Maintain silence.</p><p>✓ No food or drinks permitted.</p><p>✓ Leave the space clean.</p></div><button id="acknowledgeRulesBtn" class="primary-button w-full mt-8">Acknowledge & Continue</button></div>
                <div id="roomsStep3" class="step-content"><h2 class="form-title">Select Location</h2><p class="form-subtitle">Book a <span id="roomTypeDisplay" class="font-semibold text-gray-800"></span> at:</p><div class="space-y-4 mt-8"><button class="option-button" data-location="Dallah">📍 Dallah</button><button class="option-button" data-location="VHUB1">📍 VHUB1</button><button class="option-button" data-location="Zayyan">📍 Zayyan</button></div></div>
                <div id="roomsStep4" class="step-content"><h2 class="form-title">Select Date & Time</h2><p class="form-subtitle">Booking at <span id="locationDisplay" class="font-semibold text-gray-800"></span>.</p><div class="mt-4"><div id="calendar" class="w-full bg-white p-4 rounded-xl styled-card"></div><div id="timeSlotsContainer" class="mt-4 hidden"><h3 class="font-semibold text-center mb-2 text-gray-800">Available Slots</h3><div id="timeSlots" class="grid grid-cols-3 sm:grid-cols-4 gap-2"></div></div></div></div>
                <div id="roomsStep5" class="step-content text-center flex flex-col justify-center h-full relative">
                    <div class="confirmation-icon"><div class="flat-icon icon-rooms" style="width: 100%; height: 100%; color: rgba(0,0,0,0.05);"></div></div>
                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><h2 class="form-title mt-6">Booking Confirmed!</h2><p class="mt-2 text-gray-500">A confirmation has been sent to your email.</p><div id="bookingSummary" class="mt-6 text-left bg-white p-4 rounded-lg text-sm styled-card"></div><button class="primary-button mt-8 w-full navigate-home">Done</button></div>
            </div>
        </div>
        <div id="screen-wellness" class="screen">
            <div class="screen-header"><button class="navigate-back text-2xl font-bold">←</button><h2 class="screen-title">Health & Wellness</h2><div class="w-8"></div></div>
            <div class="screen-body">
                <div id="wellnessStep1" class="step-content active"><h2 class="form-title">Health & Wellness</h2><p class="form-subtitle">Select a service to proceed.</p><div class="space-y-4 mt-8"><button class="option-button" data-wellness-type="gymSubscription">Request Gym Subscription</button><button class="option-button opacity-50 cursor-not-allowed" disabled>Cancel Subscription <span class="text-xs font-normal">(Coming Soon)</span></button></div></div>
                <div id="wellnessStep2" class="step-content"><h2 class="form-title">Gym Subscription</h2><p class="form-subtitle">Complete the form to join.</p><form id="gymForm" class="space-y-4 mt-6 text-left text-sm"><label class="block font-medium text-gray-700">Employee Name<input type="text" value="Amr Megahed" class="form-input mt-1 bg-gray-100" readonly></label><label class="block font-medium text-gray-700">Staff ID No.<input type="text" value="12345" class="form-input mt-1 bg-gray-100" readonly></label><label class="block font-medium text-gray-700">Location</label><div class="mt-1 p-3 border border-gray-200 rounded-lg bg-white"><label class="flex items-center"><input type="radio" name="location" value="V-HUB" class="h-4 w-4 text-red-600 focus:ring-red-500" required checked><span class="ml-3">V-HUB</span></label></div><div class="space-y-2"><label class="block font-medium text-gray-700">Disclaimers</label><div class="relative flex items-start p-3 border border-gray-200 rounded-lg bg-white"><div class="flex h-5 items-center"><input id="disclaimer1" type="checkbox" class="h-4 w-4 rounded text-red-600 focus:ring-red-500" required></div><div class="ml-3 text-sm"><label for="disclaimer1">Membership is activated next month.</label></div></div><div class="relative flex items-start p-3 border border-gray-200 rounded-lg bg-white"><div class="flex h-5 items-center"><input id="disclaimer2" type="checkbox" class="h-4 w-4 rounded text-red-600 focus:ring-red-500" required></div><div class="ml-3 text-sm"><label for="disclaimer2">Book visits via the gym's admin at VHUB2.</label></div></div></div><button type="submit" class="primary-button w-full !mt-6">Submit</button></form></div>
                <div id="wellnessStep3" class="step-content text-center flex flex-col justify-center h-full"><svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><h2 class="form-title mt-6">Request Received!</h2><p class="mt-2 text-gray-500">Your gym subscription request has been submitted.</p><button class="primary-button mt-8 w-full navigate-home">Done</button></div>
            </div>
        </div>
        <div id="screen-requests" class="screen">
            <div class="screen-header"><button class="navigate-back text-2xl font-bold">←</button><h2 class="screen-title">Service Requests</h2><div class="w-8"></div></div>
            <div class="screen-body">
                <div id="requestsStep1" class="step-content active"><h2 class="form-title">Service Requests</h2><p class="form-subtitle">What would you like to request?</p><div class="space-y-4 mt-8"><button class="option-button" data-request-type="stationery">Request Stationery</button><button class="option-button" data-request-type="mailroom">Mailroom Request</button></div></div>
                <div id="requestsStep2" class="step-content"><h2 class="form-title">Stationery Request</h2><form id="stationeryForm" class="space-y-3 mt-6 text-left text-sm"><label class="text-gray-700">Requester E-mail<input type="email" value="amr.megahed@vodafone.com" class="form-input mt-1 bg-gray-100" readonly></label><label class="text-gray-700">Location<select id="stationeryLocation" class="form-input mt-1" required><option>VHUBs</option><option>Dallah</option><option>Zayyan</option></select></label><p class="font-semibold pt-2 text-gray-700">Frequent Items</p><div class="flex gap-2"><button type="button" class="text-xs border p-2 rounded-md hover:bg-gray-100 bg-white text-gray-800 border-gray-200">Whiteboard Marker</button><button type="button" class="text-xs border p-2 rounded-md hover:bg-gray-100 bg-white text-gray-800 border-gray-200">Notebook</button></div><div class="grid grid-cols-3 gap-2 text-gray-700"><div class="col-span-2"><label for="stationeryItem1">Item 1</label><input type="text" id="stationeryItem1" class="form-input auto-focuser" required></div><div><label for="stationeryQty1">Qty</label><input type="number" id="stationeryQty1" class="form-input auto-focuser" required min="1"></div></div><button type="submit" class="primary-button w-full !mt-6">Submit Request</button></form></div>
                <div id="requestsStep3" class="step-content text-center flex flex-col justify-center h-full"><svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><h2 class="form-title mt-6">Request Sent!</h2><p class="mt-2 text-gray-500">Your stationery request has been sent.</p><button class="primary-button mt-8 w-full navigate-home">Done</button></div>
                <div id="requestsStep4" class="step-content"><h2 class="form-title">Mailroom Request</h2><form id="mailroomForm" class="space-y-3 mt-6 text-left text-sm text-gray-700"><div class="grid grid-cols-2 gap-2"><label>Employee Name<input type="text" value="Amr Megahed" class="form-input mt-1 bg-gray-100" readonly></label><label>Staff ID No.<input type="text" value="12345" class="form-input mt-1 bg-gray-100" readonly></label></div><label>Mobile Number<input type="tel" class="form-input mt-1" required></label><label>From (Location)<select id="mailroomFrom" class="form-input mt-1" required><option>VHUBs</option><option>Dallah</option><option>Zayyan</option></select></label><label>To (Location)<select id="mailroomTo" class="form-input mt-1" required><option>VHUBs</option><option>Dallah</option><option>Zayyan</option><option>Other</option></select></label><label>Description<textarea id="mailroomDescription" rows="2" class="form-input mt-1" placeholder="e.g., Internal documents..." required></textarea></label><button type="submit" class="primary-button w-full !mt-6">Submit Request</button></form></div>
                <div id="requestsStep5" class="step-content text-center flex flex-col justify-center h-full"><svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><h2 class="form-title mt-6">Request Submitted!</h2><p class="mt-2 text-gray-500">Your mail request has been sent.</p<button class="primary-button mt-8 w-full navigate-home">Done</button></div>
            </div>
        </div>
        <div id="screen-transport" class="screen">
            <div class="screen-header"><button class="navigate-back text-2xl font-bold">←</button><h2 class="screen-title">Food & Transport</h2><div class="w-8"></div></div>
            <div class="screen-body flex flex-col items-center justify-center text-center"><h2 class="form-title">Coming Soon</h2><p class="form-subtitle">This feature is currently under development.</p></div>
        </div>
        <div id="screen-ticketing" class="screen">
            <div class="screen-header"><button class="navigate-back text-2xl font-bold">←</button><h2 class="screen-title">Submit a Ticket</h2><div class="w-8"></div></div>
            <div class="screen-body">
                <div id="ticketingStep1" class="step-content active"><h2 class="form-title">Trouble Ticket</h2><form id="ticketForm" class="space-y-3 mt-6 text-left text-sm text-gray-700"><div class="grid grid-cols-2 gap-2"><label>Category<select id="ticketCategory" class="form-input mt-1" required><option>Facilities</option><option>Property (Civil)</option><option>Property (Electricity)</option><option>Property (Mechanical)</option><option>H&S</option></select></label><label>Sub-Category<select id="ticketSubCategory" class="form-input mt-1" required></select></label></div><label>Location<input type="text" id="ticketLocation" value="Dallah Building (auto-detected)" readonly class="form-input mt-1 bg-gray-100"></label><label>Description of Issue<textarea id="ticketDescription" rows="4" class="form-input mt-1" required placeholder="Please provide as much detail as possible..."></textarea></label><button type="submit" class="primary-button w-full !mt-6">Submit Ticket</button></form></div>
                <div id="ticketingStep2" class="step-content text-center flex flex-col justify-center h-full"><svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg><h2 class="form-title mt-6">Ticket Submitted!</h2><p class="mt-2 text-gray-500">Our team will look into the issue shortly.</p><button class="primary-button mt-8 w-full navigate-home">Done</button></div>
            </div>
        </div>

        <nav id="bottom-navbar" class="absolute bottom-4 left-1/2 -translate-x-1/2 nav-bar z-20">
            <button data-target-screen="screen-main" class="nav-item active">
                <div class="flat-icon icon-home"></div>
                <span class="nav-text">Home</span>
            </button>
            <button data-target-screen="screen-activity" class="nav-item">
                <div class="flat-icon icon-activity"></div>
                 <span class="nav-text">Activity</span>
            </button>
        </nav>

        <button id="fab" class="absolute bottom-4 right-4 z-20 w-14 h-14 rounded-2xl bg-gray-800 text-white shadow-lg flex items-center justify-center transition-transform active:scale-95">
             <span class="text-3xl font-thin">+</span>
        </button>

        <div id="action-sheet-overlay" class="action-sheet-overlay">
            <div class="action-sheet-container">
                 <div class="w-12 h-1.5 bg-gray-300 rounded-full mx-auto mb-4"></div>
                <div class="flex flex-col space-y-2 w-full">
                     <button data-target-screen="screen-rooms" class="action-sheet-item">
                        <div class="flat-icon-container"><div class="flat-icon icon-rooms"></div></div>
                        <span class="text-lg font-semibold">Rooms</span>
                    </button>
                    <button data-target-screen="screen-requests" class="action-sheet-item">
                         <div class="flat-icon-container"><div class="flat-icon icon-requests"></div></div>
                        <span class="text-lg font-semibold">Requests</span>
                    </button>
                    <button data-target-screen="screen-wellness" class="action-sheet-item">
                        <div class="flat-icon-container"><div class="flat-icon icon-wellness"></div></div>
                        <span class="text-lg font-semibold">Wellness</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const appState = {
            booking: { room: null, location: null, date: null, time: null },
            history: ['screen-main'],
            currentLocation: "Dallah Building, Alexandria"
        };

        function updateNavActiveState(activeScreenId) {
            const navItems = document.querySelectorAll('.nav-item');
            let tabId = 'screen-main';
            
            const screenToTabMap = {
                'screen-main': 'screen-main',
                'screen-rooms': 'screen-main',
                'screen-requests': 'screen-main',
                'screen-wellness': 'screen-main',
                'screen-ticketing': 'screen-main',
                'screen-transport': 'screen-main',
                'screen-location': 'screen-main',
                'screen-activity': 'screen-activity',
            };
            tabId = screenToTabMap[activeScreenId] || 'screen-main';

            navItems.forEach(item => {
                if (item.dataset.targetScreen === tabId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        
        function navigateTo(screenId, isBack = false, isTabNav = false) {
            const allScreens = document.querySelectorAll('.screen');
            const currentScreen = document.querySelector('.screen.active');
            const targetScreen = document.getElementById(screenId);
            if (!targetScreen) return;

            if (isTabNav) {
                appState.history = [screenId];
            } else if (!isBack) {
                appState.history.push(screenId);
            }
            
            allScreens.forEach(s => s.classList.remove('active'));
            targetScreen.classList.add('active');

            updateNavActiveState(screenId);
        }

        function navigateBack() {
            if (appState.history.length <= 1) {
                navigateTo('screen-main', false, true);
                return;
            }; 

            appState.history.pop();
            const prevScreenId = appState.history[appState.history.length - 1];
            
            const allScreens = document.querySelectorAll('.screen');
            allScreens.forEach(s => s.classList.remove('active'));
            document.getElementById(prevScreenId).classList.add('active');
            
            updateNavActiveState(prevScreenId);
        }
        
        function goToStep(screenElement, stepNumber) {
            const steps = screenElement.querySelectorAll('.step-content');
            steps.forEach(step => step.classList.remove('active'));
            const targetStep = screenElement.querySelector(`#${screenElement.id.replace('screen-','')}Step${stepNumber}`);
            if(targetStep) targetStep.classList.add('active');
        }

        function initActionSheet() {
            const overlay = document.getElementById('action-sheet-overlay');
            const fab = document.getElementById('fab');
            const items = document.querySelectorAll('.action-sheet-item');

            function toggleSheet() {
                overlay.classList.toggle('open');
            }

            fab.addEventListener('click', toggleSheet);
            overlay.addEventListener('click', (e) => {
                if(e.target === overlay) {
                    toggleSheet();
                }
            });
            items.forEach(item => {
                 item.addEventListener('click', () => {
                    navigateTo(item.dataset.targetScreen);
                    setTimeout(toggleSheet, 50);
                });
            });
        }
        
        document.querySelectorAll('.nav-item').forEach(element => {
            element.addEventListener('click', () => navigateTo(element.dataset.targetScreen, false, true));
        });
        document.querySelectorAll('[data-target-screen]:not(.nav-item)').forEach(element => {
            element.addEventListener('click', () => navigateTo(element.dataset.targetScreen));
        });
        
        document.querySelectorAll('.navigate-back').forEach(btn => btn.addEventListener('click', navigateBack));
        document.querySelectorAll('.navigate-home').forEach(btn => {
            btn.addEventListener('click', () => {
                navigateTo('screen-main', false, true);
                 document.querySelectorAll('.screen').forEach(s => {
                    if(s.id !== 'screen-main') {
                         const steps = s.querySelectorAll('.step-content');
                         if (steps.length > 0) {
                            steps.forEach(step => step.classList.remove('active'));
                            steps[0].classList.add('active');
                         }
                    }
                });
            });
        });
        
        function setGreeting() {
            const hour = new Date().getHours();
            let greetingText = "Good Morning";
            if (hour >= 12 && hour < 17) greetingText = "Good Afternoon";
            if (hour >= 17) greetingText = "Good Evening";
            document.getElementById('greeting').innerHTML = `${greetingText}, <span style="color: #DC2626;">Amr!</span>`;
        }

        function handleRoomBookingFlow() {
            const screen = document.getElementById('screen-rooms');
            screen.querySelectorAll('#roomsStep1 button[data-room-type]').forEach(b => b.addEventListener('click', () => {
                appState.booking.room = b.dataset.roomType;
                screen.querySelector('#roomTypeDisplay').textContent = appState.booking.room;
                goToStep(screen, appState.booking.room === 'Meditation Room' ? 2 : 3);
            }));
            screen.querySelector('#acknowledgeRulesBtn')?.addEventListener('click', () => goToStep(screen, 3));
            screen.querySelectorAll('#roomsStep3 button[data-location]').forEach(b => b.addEventListener('click', () => {
                appState.booking.location = b.dataset.location;
                screen.querySelector('#locationDisplay').textContent = appState.booking.location;
                renderCalendar(new Date().getFullYear(), new Date().getMonth());
                goToStep(screen, 4);
            }));
        }
        function handleWellnessFlow() {
            const screen = document.getElementById('screen-wellness');
            screen.querySelector('[data-wellness-type="gymSubscription"]')?.addEventListener('click', () => goToStep(screen, 2));
            screen.querySelector('#gymForm')?.addEventListener('submit', (e) => { e.preventDefault(); goToStep(screen, 3); });
        }
        function handleRequestFlow() {
            const screen = document.getElementById('screen-requests');
            screen.querySelector('[data-request-type="stationery"]')?.addEventListener('click', () => goToStep(screen, 2));
            screen.querySelector('[data-request-type="mailroom"]')?.addEventListener('click', () => goToStep(screen, 4));
            screen.querySelector('#stationeryForm')?.addEventListener('submit', e => { e.preventDefault(); goToStep(screen, 3); });
            screen.querySelector('#mailroomForm')?.addEventListener('submit', e => { e.preventDefault(); goToStep(screen, 5); });
        }
        function handleTicketingFlow() {
            const screen = document.getElementById('screen-ticketing');
            const cats = {"Facilities": ["Housekeeping", "Business support", "Caterers", "GYM"],"Property (Civil)": ["Plumbing", "Painting", "Carpentry"],"Property (Electricity)": ["Lighting", "Power", "Power socket"],"Property (Mechanical)": ["AC", "Firefighting"],"H&S": ["Hazard"]};
            const catEl = document.getElementById('ticketCategory');
            const subCatEl = document.getElementById('ticketSubCategory');
            function updateSubCats() { subCatEl.innerHTML = cats[catEl.value].map(s => `<option>${s}</option>`).join(''); }
            catEl.addEventListener('change', updateSubCats);
            if (catEl.value) updateSubCats();
            screen.querySelector('#ticketForm')?.addEventListener('submit', e => { e.preventDefault(); goToStep(screen, 2); });
        }
       

        function renderCalendar(year, month) {
            const calEl = document.getElementById('calendar'); calEl.innerHTML = '';
            document.getElementById('timeSlotsContainer').style.display = 'none';
            calEl.className = 'grid grid-cols-7 gap-1 text-gray-800'
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            calEl.insertAdjacentHTML('beforeend', `<div class="col-span-7 text-center font-semibold mb-2">${new Date(year, month).toLocaleString('default', { month: 'long', year: 'numeric' })}</div>`);
            ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'].forEach(d => calEl.insertAdjacentHTML('beforeend', `<div class="text-center font-medium text-xs text-gray-400">${d}</div>`));
            for (let i = 0; i < firstDay; i++) calEl.insertAdjacentHTML('beforeend', '<div></div>');
            for (let i = 1; i <= daysInMonth; i++) {
                let dayEl = document.createElement('div');
                dayEl.className = 'text-center py-2 rounded-full cursor-pointer hover:bg-red-100 transition-colors';
                dayEl.textContent = i;
                if (i === new Date().getDate() && month === new Date().getMonth()) dayEl.classList.add('bg-gray-800', 'text-white', '!hover:bg-gray-900');
                dayEl.addEventListener('click', () => {
                    calEl.querySelectorAll('.bg-gray-800').forEach(d => d.classList.remove('bg-gray-800', 'text-white', '!hover:bg-gray-900'));
                    dayEl.classList.add('bg-gray-800', 'text-white', '!hover:bg-gray-900');
                    appState.booking.date = `${new Date(year, month, i).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}`;
                    showTimeSlots(i);
                });
                calEl.appendChild(dayEl);
            }
        }
        function showTimeSlots(day) {
            document.getElementById('timeSlotsContainer').style.display = 'block';
            const slotsEl = document.getElementById('timeSlots'); slotsEl.innerHTML = '';
            ["10:00 AM", "10:30 AM", "11:00 AM", "11:30 AM", "01:00 PM", "01:30 PM", "02:30 PM", "03:00 PM"].forEach(slot => {
                let slotEl = document.createElement('button');
                slotEl.className = 'p-2 border rounded-md text-sm hover:bg-gray-100 bg-white transition-colors border-gray-200 text-gray-800';
                slotEl.textContent = slot;
                slotEl.addEventListener('click', () => {
                     slotsEl.querySelectorAll('.bg-gray-800').forEach(d => d.classList.remove('bg-gray-800', 'text-white'));
                     slotEl.classList.add('bg-gray-800', 'text-white');
                     appState.booking.time = slot;
                     confirmBooking();
                });
                slotsEl.appendChild(slotEl);
            });
        }
        function confirmBooking(){
            if(!appState.booking.date) appState.booking.date = `${new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}`;
            document.getElementById('bookingSummary').innerHTML = `<p class="text-gray-600"><strong class="text-gray-800">Room:</strong> ${appState.booking.room}</p><p class="text-gray-600"><strong class="text-gray-800">Location:</strong> ${appState.booking.location}</p><p class="text-gray-600"><strong class="text-gray-800">Date:</strong> ${appState.booking.date}</p><p class="text-gray-600"><strong class="text-gray-800">Time:</strong> ${appState.booking.time}</p>`;
            goToStep(document.getElementById('screen-rooms'), 5);
        }
        
        function initWeatherWidget() {
            const weatherWidget = document.getElementById('weather-widget');
            if (weatherWidget) {
                weatherWidget.innerHTML = `
                    <div class="font-bold text-lg text-white">28°C</div>
                    <div class="text-xs text-white/80">Alexandria</div>
                `;
            }
        }

        function initDynamicHub() {
            const hour = new Date().getHours();
            const suggestionWidget = document.getElementById('smart-suggestion-widget');
            const requestsWidget = document.getElementById('requests-widget');

            if (!suggestionWidget || !requestsWidget) return;

            let suggestionHTML = '';
             if (hour >= 14 && hour < 15) { 
                 suggestionHTML = `
                    <div class="bg-red-50 border border-red-200 p-4 rounded-xl text-left">
                        <p class="font-bold text-red-800">💡 Smart Suggestion</p>
                        <p class="text-sm text-red-700/80 mt-1">Your **Meditation Room** booking is in 23 minutes at Dallah. <a href="#" class="font-bold text-gray-800">Get Directions</a></p>
                    </div>`;
             }
            suggestionWidget.innerHTML = suggestionHTML;
            
            requestsWidget.innerHTML = `
                <div class="styled-card p-4">
                    <h2 class="font-bold text-gray-800 mb-2 flex items-center">
                        <div class="flat-icon-container mr-3 !bg-red-50 !text-red-600"><div class="flat-icon icon-stationery"></div></div>
                        My Recent Requests
                    </h2>
                     <div class="mt-3">
                         <p class="text-sm font-semibold text-gray-700">Stationery Request</p>
                         <div class="mt-2">
                             <div class="flex justify-between">
                                <span class="text-xs font-medium text-green-600">Reviewing</span>
                                <span class="text-xs font-medium text-gray-400">2 of 3</span>
                             </div>
                             <div class="w-full bg-gray-200 rounded-full h-1.5 mt-1">
                                <div class="bg-green-500 h-1.5 rounded-full" style="width: 66%"></div>
                             </div>
                         </div>
                    </div>
                </div>`;
        }
        
        function initActivityLog() {
            const logContainer = document.getElementById('activity-log');
            if (!logContainer) return;
            logContainer.innerHTML = `
                <div class="styled-card p-4">
                    <div class="flex items-center">
                        <div class="flat-icon-container mr-3 !bg-red-50 !text-red-600"><div class="flat-icon icon-calendar"></div></div>
                        <div>
                            <p class="font-semibold">Meditation Room Booking</p>
                            <p class="text-sm text-gray-500">Today at 2:30 PM</p>
                        </div>
                        <span class="ml-auto text-xs font-medium text-green-600 bg-green-100 px-2 py-1 rounded-full">Confirmed</span>
                    </div>
                </div>
                <div class="styled-card p-4">
                    <div class="flex items-center">
                        <div class="flat-icon-container mr-3 !bg-red-50 !text-red-600"><div class="flat-icon icon-stationery"></div></div>
                        <div>
                            <p class="font-semibold">Stationery Request</p>
                            <p class="text-sm text-gray-500">Yesterday</p>
                        </div>
                        <span class="ml-auto text-xs font-medium text-gray-600 bg-gray-200 px-2 py-1 rounded-full">Completed</span>
                    </div>
                </div>
            `;
        }

         function handleLocationChange() {
            const locationOptions = document.getElementById('location-options');
            const currentLocationDisplay = document.getElementById('current-location-display');
            
            function updateSelection() {
                locationOptions.querySelectorAll('button').forEach(btn => {
                    if (btn.dataset.location === appState.currentLocation) {
                        btn.querySelector('span').textContent = '✓';
                        btn.classList.add('!border-red-500', 'ring-2', 'ring-red-200');
                    } else {
                        btn.querySelector('span').textContent = '';
                        btn.classList.remove('!border-red-500', 'ring-2', 'ring-red-200');
                    }
                });
                currentLocationDisplay.textContent = appState.currentLocation;
            }

            locationOptions.addEventListener('click', (e) => {
                const button = e.target.closest('button');
                if (button && button.dataset.location) {
                    appState.currentLocation = button.dataset.location;
                    updateSelection();
                    setTimeout(navigateBack, 300);
                }
            });
            updateSelection();
        }

        function initAnimations() {
            const elements = document.querySelectorAll('.load-in');
             setTimeout(() => {
                elements.forEach(el => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                });
            }, 100);
        }

        setGreeting();
        initWeatherWidget();
        initDynamicHub();
        initActivityLog();
        handleRoomBookingFlow();
        handleWellnessFlow();
        handleRequestFlow();
        handleTicketingFlow();
        initAnimations();
        initActionSheet();
        handleLocationChange();
    });
    </script>
</body>
</html>

